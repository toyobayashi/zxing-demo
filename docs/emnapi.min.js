!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).__emnapi_runtime__={})}(this,(function(t){"use strict";var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},e(t,i)};function i(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var n,r=function(t,e){void 0===e&&(e=null),this.value=t,this.next=e},o=function(){function t(){this.head=null,this.tail=null}return t.prototype.push=function(t){if(null===this.tail)this.head=this.tail=new r(t);else{var e=new r(t);this.tail.next=e,this.tail=e}},t.prototype.shift=function(){if(null!==this.head){var t=this.head;this.head===this.tail?this.head=this.tail=null:this.head=this.head.next;var e=t.value;return t.next=null,e}},t.prototype.clear=function(){this.head=this.tail=null},t}(),s=function(){function t(t){this._values=[void 0],this._values.length=t,this._size=1,this._freeList=new o}return t.prototype.add=function(t){var e;this._freeList.head?e=this._freeList.shift():(e=this._size,this._size++),e>=this._values.length&&(this._values.length=Math.ceil(1.5*this._values.length)),t.id=e,this._values[e]=t},t.prototype.get=function(t){return this._values[t]},t.prototype.has=function(t){return void 0!==this._values[t]},t.prototype.remove=function(t){var e=this._values[t];e&&(e.id=0,this._values[t]=void 0,this._freeList.push(t))},t.prototype.dispose=function(){for(var t=1;t<this._size;++t){var e=this._values[t];null==e||e.dispose()}this._values=[void 0],this._size=1,this._freeList.clear()},t}(),a=function(){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(t){if("undefined"!=typeof globalThis)return globalThis;if("undefined"==typeof __webpack_public_path__&&"undefined"!=typeof global)return global;if("undefined"!=typeof window)return window;if("undefined"!=typeof self)return self}return t}(),u=function(){function t(){this._exception=void 0,this._caught=!1}return t.prototype.hasCaught=function(){return this._caught},t.prototype.exception=function(){return this._exception},t.prototype.setError=function(t){this._exception=t,this._caught=!0},t.prototype.reset=function(){this._exception=void 0,this._caught=!1},t.prototype.extractException=function(){var t=this._exception;return this.reset(),t},t}(),h=function(t){function e(){return t.call(this,4)||this}return i(e,t),e}(s),l=new h;function c(t,e){if(0===t)return 1;var i=l.get(t);return void 0===i?1:e(i)}t.canSetFunctionName=!1;try{t.canSetFunctionName=!!(null===(n=Object.getOwnPropertyDescriptor(Function.prototype,"name"))||void 0===n?void 0:n.configurable)}catch(t){}var p,f="undefined"!=typeof FinalizationRegistry&&"undefined"!=typeof WeakRef,d="undefined"!=typeof BigInt;function y(t){return"object"==typeof t&&null!==t||"function"==typeof t}var v=function(t){function e(e){var i=t.call(this,16)||this;return i._objWeakMap=new WeakMap,t.prototype.add.call(i,new _(e,1,void 0)),t.prototype.add.call(i,new _(e,2,null)),t.prototype.add.call(i,new _(e,3,!1)),t.prototype.add.call(i,new _(e,4,!0)),t.prototype.add.call(i,new _(e,5,a)),i}return i(e,t),Object.defineProperty(e,"getMinId",{get:function(){return 6},enumerable:!1,configurable:!0}),e.prototype.add=function(e){if(t.prototype.add.call(this,e),y(e.value)){if(this._objWeakMap.has(e.value))this._objWeakMap.get(e.value).moveTo(e);this._objWeakMap.set(e.value,e)}},e.prototype.remove=function(i){!this.has(i)||i<e.getMinId||t.prototype.remove.call(this,i)},e.prototype.getObjectHandle=function(t){return this._objWeakMap.get(t)},e.prototype.dispose=function(){this._objWeakMap=null,t.prototype.dispose.call(this)},e.ID_UNDEFINED=1,e.ID_NULL=2,e.ID_FALSE=3,e.ID_TRUE=4,e.ID_GLOBAL=5,e.globalConstants=((p={})[e.ID_UNDEFINED]=void 0,p[e.ID_NULL]=null,p[e.ID_FALSE]=!1,p[e.ID_TRUE]=!0,p[e.ID_GLOBAL]=a,p),e}(s),_=function(){function t(t,e,i){this.wrapped=0,this._envObject=t,this.id=e,this.value=i,this.inScope=null,this.wrapped=0,this.tag=null,this.refs=[]}return t.create=function(e,i){var n=new t(e,0,i);return e.handleStore.add(n),n},Object.defineProperty(t.prototype,"env",{get:function(){var t,e;return null!==(e=null===(t=this._envObject)||void 0===t?void 0:t.id)&&void 0!==e?e:0},enumerable:!1,configurable:!0}),t.prototype.moveTo=function(t){this._envObject=void 0,this.id=0,this.value=void 0,this.inScope=null,t.wrapped=this.wrapped,this.wrapped=0,t.tag=this.tag,this.tag=null,t.refs=this.refs,this.refs=[]},t.prototype.isEmpty=function(){return 0===this.id},t.prototype.isNumber=function(){return!this.isEmpty()&&"number"==typeof this.value},t.prototype.isBigInt=function(){return!this.isEmpty()&&"bigint"==typeof this.value},t.prototype.isString=function(){return!this.isEmpty()&&"string"==typeof this.value},t.prototype.isFunction=function(){return!this.isEmpty()&&"function"==typeof this.value},t.prototype.isExternal=function(){return!this.isEmpty()&&this instanceof g},t.prototype.isObject=function(){return!this.isEmpty()&&"object"==typeof this.value&&null!==this.value},t.prototype.isArray=function(){return!this.isEmpty()&&Array.isArray(this.value)},t.prototype.isArrayBuffer=function(){return!this.isEmpty()&&this.value instanceof ArrayBuffer},t.prototype.isTypedArray=function(){return!this.isEmpty()&&ArrayBuffer.isView(this.value)&&!(this.value instanceof DataView)},t.prototype.isDataView=function(){return!this.isEmpty()&&this.value instanceof DataView},t.prototype.isDate=function(){return!this.isEmpty()&&this.value instanceof Date},t.prototype.isPromise=function(){return!this.isEmpty()&&this.value instanceof Promise},t.prototype.isBoolean=function(){return!this.isEmpty()&&"boolean"==typeof this.value},t.prototype.isUndefined=function(){return!this.isEmpty()&&void 0===this.value},t.prototype.isSymbol=function(){return!this.isEmpty()&&"symbol"==typeof this.value},t.prototype.isNull=function(){return!this.isEmpty()&&null===this.value},t.prototype.addRef=function(t){-1===this.refs.indexOf(t)&&this.refs.push(t)},t.prototype.removeRef=function(t){var e=this.refs.indexOf(t);-1!==e&&this.refs.splice(e,1),this.tryDispose()},t.prototype.tryDispose=function(){this.id<v.getMinId||null!==this.inScope||this.refs.some((function(t){return t.refcount>0}))||this.dispose()},t.prototype.dispose=function(){if(0!==this.id){if(this.refs.length>0)for(var t=this.refs,e=0;e<t.length;e++)t[e].queueFinalizer(this.value);var i=this.id;this._envObject.handleStore.remove(i),this.refs=[],this.id=0,this.value=void 0}},t}();function b(){Object.setPrototypeOf(this,null)}b.prototype=null;var g=function(t){function e(e,i){void 0===i&&(i=0);var n=t.call(this,e,0,new b)||this;return n._data=i,n}return i(e,t),e.createExternal=function(t,i){void 0===i&&(i=0);var n=new e(t,i);return t.handleStore.add(n),n},e.prototype.data=function(){return this._data},e}(_),S=function(){function t(t,e){this._disposed=!1,this._envObject=t,this.id=0,this.parent=e,this.child=null,this.handles=[]}return Object.defineProperty(t.prototype,"env",{get:function(){return this._envObject.id},enumerable:!1,configurable:!0}),t._create=function(t,e){var i=new this(t,e);return e&&(e.child=i),t.scopeStore.add(i),i},t.create=function(e,i){return t._create(e,i)},t.prototype.add=function(t){if(t instanceof _)throw new TypeError("Can not add a handle to scope");if(void 0===t)return this._envObject.handleStore.get(v.ID_UNDEFINED);if(null===t)return this._envObject.handleStore.get(v.ID_NULL);if("boolean"==typeof t)return this._envObject.handleStore.get(t?v.ID_TRUE:v.ID_FALSE);if(t===a)return this._envObject.handleStore.get(v.ID_GLOBAL);var e=_.create(this._envObject,t);return this.handles.push(e),e.inScope=this,e},t.prototype.addHandle=function(t){return-1!==this.handles.indexOf(t)||(this.handles.push(t),t.inScope=this),t},t.prototype.clearHandles=function(){if(this.handles.length>0){for(var t=this.handles,e=0;e<t.length;e++){var i=t[e];i.inScope=null,i.tryDispose()}this.handles=[]}},t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this.clearHandles(),this.parent=null,this.child=null,this._envObject.scopeStore.remove(this.id),this._envObject=void 0)},t}(),E=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._escapeCalled=!1,n}return i(e,t),e.create=function(t,i){return e._create(t,i)},e.prototype.escape=function(t){if(this._escapeCalled)return null;this._escapeCalled=!0;var e,i=!1,n=-1;if("number"==typeof t){e=t;for(var r=0;r<this.handles.length;r++)if(this.handles[r].id===e){n=r,i=!0;break}}else e=t.id,i=-1!==(n=this.handles.indexOf(t));if(i){var o=this._envObject.handleStore.get(e);return o&&null!==this.parent?(this.handles.splice(n,1),this._envObject.handleStore.remove(e),this.parent.add(o.value)):null}return null},e.prototype.escapeCalled=function(){return this._escapeCalled},e}(S),m=function(t){function e(){return t.call(this,8)||this}return i(e,t),e}(s),w=function(){function t(t,e,i,n,r,o){this.envObject=t,this._this=e,this._data=i,this._length=n,this._args=r,this._newTarget=o,this.id=0,this._isConstructCall=Boolean(o)}return t.create=function(e,i,n,r,o,s){var a=new t(e,i,n,r,o,s);return e.cbInfoStore.add(a),a},t.prototype.dispose=function(){this.envObject.cbInfoStore.remove(this.id),this.id=0,this._this=void 0,this._data=0,this._length=0,this._args=void 0,this._newTarget=void 0,this._isConstructCall=!1},t}(),j=function(t){function e(){return t.call(this,16)||this}return i(e,t),e}(s),O=function(){function t(t,e){this.id=0,this.envObject=t,this.value=e}return t.create=function(e,i){var n=new t(e,i);return e.deferredStore.add(n),n},t.prototype.resolve=function(t){this.value.resolve(t),this.dispose()},t.prototype.reject=function(t){this.value.reject(t),this.dispose()},t.prototype.dispose=function(){this.envObject.deferredStore.remove(this.id),this.id=0,this.value=null},t}(),M=function(t){function e(){return t.call(this,8)||this}return i(e,t),e}(s),D=function(){function t(t,e,i,n,r,o,s){void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),this.envObject=t,this.handle_id=e,this.deleteSelf=n,this.finalize_callback=r,this.finalize_data=o,this.finalize_hint=s,this.finalizeRan=!1,this.finalizerRegistered=!1,this.id=0,this.refcount=i>>>0}return t.create=function(e,i,n,r,o,s,a){void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0);var u=new t(e,i,n,r,o,s,a);e.refStore.add(u);var h=e.handleStore.get(i);return h.addRef(u),f&&y(h.value)?u.objWeakRef=new WeakRef(h.value):u.objWeakRef=null,u},t.prototype.ref=function(){return++this.refcount},t.prototype.unref=function(){if(0===this.refcount)return 0;if(this.refcount--,0===this.refcount){var t=this.envObject.handleStore.get(this.handle_id);t&&t.tryDispose()}return this.refcount},t.prototype.data=function(){return this.finalize_data},t.prototype.get=function(){if(this.envObject.handleStore.has(this.handle_id))return this.handle_id;if(this.objWeakRef){var t=this.objWeakRef.deref();if(t)return this.handle_id=this.envObject.ensureHandleId(t),this.handle_id}return 0},t.doDelete=function(e){var i,n;0!==e.refcount||e.deleteSelf||e.finalizeRan?(e.envObject.refStore.remove(e.id),null===(i=e.envObject.handleStore.get(e.handle_id))||void 0===i||i.removeRef(e),null===(n=t.finalizationGroup)||void 0===n||n.unregister(this)):e.deleteSelf=!0},t.prototype.queueFinalizer=function(e){t.finalizationGroup&&(this.finalizerRegistered||(e||(e=this.envObject.handleStore.get(this.handle_id).value),t.finalizationGroup.register(e,this,this),this.finalizerRegistered=!0))},t.prototype.dispose=function(){this.deleteSelf=!0,t.doDelete(this)},t.finalizationGroup="undefined"!=typeof FinalizationRegistry?new FinalizationRegistry((function(e){var i,n=!1;if(0!==e.finalize_callback){var r=e.envObject.openScope();try{e.envObject.callIntoModule((function(t){t.call_viii(e.finalize_callback,t.id,e.finalize_data,e.finalize_hint),e.finalize_callback=0}))}catch(t){n=!0,i=t}e.envObject.closeScope(r)}if(e.deleteSelf?t.doDelete(e):e.finalizeRan=!0,n)throw i})):null,t}(),A=function(t){function e(){return t.call(this,8)||this}return i(e,t),e}(s),I=function(){function t(t,e,i,n,r){var o=this;this.malloc=t,this.free=e,this.call_iii=i,this.call_viii=n,this.Module=r,this.typedArrayMemoryMap=new WeakMap,this.arrayBufferMemoryMap=new WeakMap,this.memoryPointerDeleter=f?new FinalizationRegistry((function(t){o.free(t)})):null,this.openHandleScopes=0,this.instanceData=null,this.currentScope=null,this.tryCatch=new u,this.id=0;var s=t(16);this.lastError={data:s,getErrorCode:function(){return r.HEAP32[3+(s>>2)]},setErrorCode:function(t){r.HEAP32[3+(s>>2)]=t},setErrorMessage:function(t){r.HEAP32[s>>2]=t}}}return t.create=function(e,i,n,r,o){var s=new t(e,i,n,r,o);return l.add(s),s.refStore=new A,s.handleStore=new v(s),s.deferredStore=new M,s.scopeStore=new m,s.cbInfoStore=new j,s._rootScope=S.create(s,null),s},t.prototype.openScope=function(t){if(void 0===t&&(t=S),this.currentScope){var e=t.create(this,this.currentScope);this.currentScope.child=e,this.currentScope=e}else this.currentScope=this._rootScope;return this.openHandleScopes++,this.currentScope},t.prototype.closeScope=function(t){t===this.currentScope&&(this.currentScope=t.parent),t.parent&&(t.parent.child=t.child),t.child&&(t.child.parent=t.parent),t===this._rootScope?(t.clearHandles(),t.child=null):t.dispose(),this.openHandleScopes--},t.prototype.getCurrentScope=function(){return this.currentScope},t.prototype.ensureHandleId=function(t){if(y(t)){var e=this.handleStore.getObjectHandle(t);return e?(e.value===t||(e.value=t,s.prototype.add.call(this.handleStore,e),this.currentScope.addHandle(e)),e.id):this.currentScope.add(t).id}return this.currentScope.add(t).id},t.prototype.clearLastError=function(){return this.lastError.setErrorCode(0),this.lastError.setErrorMessage(0),0},t.prototype.setLastError=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this.lastError.setErrorCode(t),t},t.prototype.getReturnStatus=function(){return this.tryCatch.hasCaught()?this.setLastError(10):0},t.prototype.callIntoModule=function(t){this.clearLastError();var e=t(this);if(this.tryCatch.hasCaught())throw this.tryCatch.extractException();return e},t.prototype.getViewPointer=function(t){return f?t.buffer===this.Module.HEAPU8.buffer?t.byteOffset:this.typedArrayMemoryMap.has(t)?(e=this.typedArrayMemoryMap.get(t),this.Module.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e),e):(e=this.malloc(t.byteLength),this.Module.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e),this.typedArrayMemoryMap.set(t,e),this.memoryPointerDeleter.register(t,e),e):0;var e},t.prototype.getArrayBufferPointer=function(t){return f&&t!==this.Module.HEAPU8.buffer?this.arrayBufferMemoryMap.has(t)?(e=this.arrayBufferMemoryMap.get(t),this.Module.HEAPU8.set(new Uint8Array(t),e),e):(e=this.malloc(t.byteLength),this.Module.HEAPU8.set(new Uint8Array(t),e),this.arrayBufferMemoryMap.set(t,e),this.memoryPointerDeleter.register(t,e),e):0;var e},t.prototype.dispose=function(){this.currentScope=null,this.deferredStore.dispose(),this.refStore.dispose(),this.scopeStore.dispose(),this.handleStore.dispose(),this.tryCatch.extractException();try{this.free(this.lastError.data),this.lastError.data=0}catch(t){}this.lastError=null,l.remove(this.id)},t}();t.CallbackInfo=w,t.CallbackInfoStore=j,t.Deferred=O,t.DeferredStore=M,t.Env=I,t.EnvStore=h,t.EscapableHandleScope=E,t.ExternalHandle=g,t.Handle=_,t.HandleScope=S,t.HandleStore=v,t.RefStore=A,t.Reference=D,t.ScopeStore=m,t.Store=s,t.TryCatch=u,t.checkArgs=function(t,e,i){for(var n=0;n<e.length;n++){if(0===e[n])return t.setLastError(1)}return i()},t.checkEnv=c,t.envStore=l,t.preamble=function(t,e){return c(t,(function(t){if(t.tryCatch.hasCaught())return t.setLastError(10);t.clearLastError();try{return e(t)}catch(e){return t.tryCatch.setError(e),t.setLastError(10)}}))},t.supportBigInt=d,t.supportFinalizer=f,Object.defineProperty(t,"__esModule",{value:!0})}));
